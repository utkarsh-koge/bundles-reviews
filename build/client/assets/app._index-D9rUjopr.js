import{R as r,r as a,j as e}from"./index-C2MVcWue.js";import{u as lt,T as Te,b as Ze,A as ot,a as q,c as yt,C as ke,B as k,d as Ct,I as wt,e as Et,P as St}from"./Page-D05pyoXj.js";import{e as Se,T as v,l as Ee,c as de,b as he,m as Fe,U as it,n as ct,o as Pt,I as F,p as Rt,a as I,B as ne,q as dt}from"./hooks-DVLPNyJj.js";import{I as Le}from"./use-deep-effect-D6mXDaV_.js";import{u as kt,a as It,w as At,x as Mt,b as Ge,c as Dt,y as Ie}from"./components-C2Kax0p1.js";import{e as Nt,S as Lt,B as Bt,R as $e,a as ze,T as ut,b as Ft,g as Wt,d as _t}from"./product.helpers-vfyxMMcL.js";import{D as je,S as Ye,T as Ot}from"./Toast-DBnrqZxP.js";import{M as J}from"./Modal-CzgmPlWy.js";import{A as Vt}from"./app.config-WQ-Mt3dF.js";import{j as $t}from"./context-BTfEV6tP.js";import{F as He}from"./FormLayout-SOrlQt4I.js";import{L as zt}from"./Link-CaZ9q6rI.js";import{T as Ut,L as Ne}from"./TitleBar-CSDd_GFP.js";import"./banner-context-DY3IUZWM.js";import"./context-C3QIEavF.js";var pt=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{fillRule:"evenodd",d:"M7 15v-2.291a3 3 0 0 1-2.5-2.959v-1.25a3 3 0 0 1 3-3h5a3 3 0 0 1 3 3v1.25a3 3 0 0 1-3 3h-2.461l-3.039 2.25Zm3.534-.75h1.966a4.5 4.5 0 0 0 4.5-4.5v-1.25a4.5 4.5 0 0 0-4.5-4.5h-5a4.5 4.5 0 0 0-4.5 4.5v1.25a4.498 4.498 0 0 0 2.5 4.032v1.218a1.5 1.5 0 0 0 2.393 1.206l2.64-1.956Zm-4.534-6.5a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1-.75-.75Zm.75 2a.75.75 0 0 0 0 1.5h3.5a.75.75 0 0 0 0-1.5h-3.5Z"}))};pt.displayName="ChatIcon";var Ke=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{d:"M11.5 8.25a.75.75 0 0 1 .75.75v4.25a.75.75 0 0 1-1.5 0v-4.25a.75.75 0 0 1 .75-.75Z"}),r.createElement("path",{d:"M9.25 9a.75.75 0 0 0-1.5 0v4.25a.75.75 0 0 0 1.5 0v-4.25Z"}),r.createElement("path",{fillRule:"evenodd",d:"M7.25 5.25a2.75 2.75 0 0 1 5.5 0h3a.75.75 0 0 1 0 1.5h-.75v5.45c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311c-.642.327-1.482.327-3.162.327h-.4c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311c-.327-.642-.327-1.482-.327-3.162v-5.45h-.75a.75.75 0 0 1 0-1.5h3Zm1.5 0a1.25 1.25 0 1 1 2.5 0h-2.5Zm-2.25 1.5h7v5.45c0 .865-.001 1.423-.036 1.848-.033.408-.09.559-.128.633a1.5 1.5 0 0 1-.655.655c-.074.038-.225.095-.633.128-.425.035-.983.036-1.848.036h-.4c-.865 0-1.423-.001-1.848-.036-.408-.033-.559-.09-.633-.128a1.5 1.5 0 0 1-.656-.655c-.037-.074-.094-.225-.127-.633-.035-.425-.036-.983-.036-1.848v-5.45Z"}))};Ke.displayName="DeleteIcon";var ht=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{d:"M11.25 8.5c-.414 0-.75.336-.75.75v1.25h-1.25c-.414 0-.75.336-.75.75s.336.75.75.75h1.25v1.25c0 .414.336.75.75.75s.75-.336.75-.75v-1.25h1.25c.414 0 .75-.336.75-.75s-.336-.75-.75-.75h-1.25v-1.25c0-.414-.336-.75-.75-.75Z"}),r.createElement("path",{fillRule:"evenodd",d:"M8.75 16.5c-1.438 0-2.618-1.104-2.74-2.51-1.406-.122-2.51-1.302-2.51-2.74v-5c0-1.519 1.231-2.75 2.75-2.75h5c1.438 0 2.618 1.104 2.74 2.51 1.406.122 2.51 1.302 2.51 2.74v5c0 1.519-1.231 2.75-2.75 2.75h-5Zm0-10.5c-1.519 0-2.75 1.231-2.75 2.75v3.725c-.57-.116-1-.62-1-1.225v-5c0-.69.56-1.25 1.25-1.25h5c.605 0 1.11.43 1.225 1h-3.725Zm0 1.5c-.69 0-1.25.56-1.25 1.25v5c0 .69.56 1.25 1.25 1.25h5c.69 0 1.25-.56 1.25-1.25v-5c0-.69-.56-1.25-1.25-1.25h-5Z"}))};ht.displayName="DuplicateIcon";var mt=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{fillRule:"evenodd",d:"M15.655 4.344a2.695 2.695 0 0 0-3.81 0l-.599.599-.009-.009-1.06 1.06.008.01-5.88 5.88a2.75 2.75 0 0 0-.805 1.944v1.922a.75.75 0 0 0 .75.75h1.922a2.75 2.75 0 0 0 1.944-.806l7.54-7.539a2.695 2.695 0 0 0 0-3.81Zm-4.409 2.72-5.88 5.88a1.25 1.25 0 0 0-.366.884v1.172h1.172c.331 0 .65-.132.883-.366l5.88-5.88-1.689-1.69Zm2.75.629.599-.599a1.195 1.195 0 1 0-1.69-1.689l-.598.599 1.69 1.689Z"}))};mt.displayName="EditIcon";var bt=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{d:"M10.75 12.75a.75.75 0 0 1-1.5 0v-6.69l-1.72 1.72a.75.75 0 0 1-1.06-1.06l3-3a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1-1.06 1.06l-1.72-1.72v6.69Z"}),r.createElement("path",{d:"M16.5 13.75a.75.75 0 0 0-1.5 0v.76a.75.75 0 0 1-.75.75h-8.5a.75.75 0 0 1-.75-.75v-.76a.75.75 0 0 0-1.5 0v.76a2.25 2.25 0 0 0 2.25 2.25h8.5a2.25 2.25 0 0 0 2.25-2.25v-.76Z"}))};bt.displayName="ExportIcon";var gt=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{fillRule:"evenodd",d:"M3 6.75c0-2.071 1.679-3.75 3.75-3.75h6.5c2.071 0 3.75 1.679 3.75 3.75v6.5c0 2.071-1.679 3.75-3.75 3.75h-6.5c-2.071 0-3.75-1.679-3.75-3.75v-6.5Zm3.75-2.25c-1.243 0-2.25 1.007-2.25 2.25v6.5c0 1.243 1.007 2.25 2.25 2.25h.5v-11h-.5Zm4.5 11h-2.5v-11h2.5v11Zm1.5 0h.5c1.243 0 2.25-1.007 2.25-2.25v-6.5c0-1.243-1.007-2.25-2.25-2.25h-.5v11Z"}))};gt.displayName="LayoutColumns3Icon";var ft=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{d:"M7.75 6.06v7.69a.75.75 0 0 1-1.5 0v-7.69l-1.72 1.72a.75.75 0 0 1-1.06-1.06l3-3a.75.75 0 0 1 1.06 0l3 3a.75.75 0 1 1-1.06 1.06l-1.72-1.72Z"}),r.createElement("path",{d:"M13.75 6.25a.75.75 0 0 0-1.5 0v7.69l-1.72-1.72a.75.75 0 1 0-1.06 1.06l3 3a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06l-1.72 1.72v-7.69Z"}))};ft.displayName="SortIcon";var Ce=function(l){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},l),r.createElement("path",{d:"M11.128 4.123c-.453-.95-1.803-.95-2.256 0l-1.39 2.912-3.199.421c-1.042.138-1.46 1.422-.697 2.146l2.34 2.222-.587 3.172c-.192 1.034.901 1.828 1.825 1.327l2.836-1.54 2.836 1.54c.924.501 2.017-.293 1.825-1.327l-.587-3.172 2.34-2.222c.762-.724.345-2.008-.697-2.146l-3.2-.421-1.389-2.912Z"}))};Ce.displayName="StarFilledIcon";function qe({acceptCharset:t,action:l,autoComplete:s,children:b,encType:c,implicitSubmit:o=!0,method:m="post",name:n,noValidate:d,preventDefault:u=!0,target:x,onSubmit:p}){const f=Se(),j=a.useCallback(h=>{u&&(h.preventDefault(),p(h))},[p,u]),T=Zt(s),E=o?r.createElement(v,{as:"span",visuallyHidden:!0},r.createElement("button",{type:"submit","aria-hidden":"true",tabIndex:-1},f.translate("Polaris.Common.submit"))):null;return r.createElement("form",{acceptCharset:t,action:l,autoComplete:T,encType:c,method:m,name:n,noValidate:d,target:x,onSubmit:j},E,b)}function Zt(t){return t==null?t:t?"on":"off"}function Gt(){const[t,l]=a.useState(!1),s=a.useCallback(()=>l(!0),[]);return lt("touchstart",s),t}function Qe(t){const l=a.useRef();return a.useEffect(()=>{l.current=t},[t]),l.current}function et(t,l,s,b,c){const o=b.reduce((u,x)=>u+x,0),m=t.map((u,x)=>x),n=[],d=[];if(c>o)n.push(...m);else{n.push(l);let u=b[l];m.forEach(x=>{if(x!==l){const p=b[x];if(u+p>=c-s){d.push(x);return}n.push(x),u+=p}})}return{visibleTabs:n,hiddenTabs:d}}var P={Outer:"Polaris-Tabs__Outer",Wrapper:"Polaris-Tabs__Wrapper",WrapperWithNewButton:"Polaris-Tabs__WrapperWithNewButton",ButtonWrapper:"Polaris-Tabs__ButtonWrapper",Tabs:"Polaris-Tabs",Tab:"Polaris-Tabs__Tab","Tab-active":"Polaris-Tabs__Tab--active","Tab-hasActions":"Polaris-Tabs__Tab--hasActions","Tab-iconOnly":"Polaris-Tabs__Tab--iconOnly",fillSpace:"Polaris-Tabs--fillSpace",TabContainer:"Polaris-Tabs__TabContainer",fitted:"Polaris-Tabs--fitted",List:"Polaris-Tabs__List",Item:"Polaris-Tabs__Item",DisclosureTab:"Polaris-Tabs__DisclosureTab","DisclosureTab-visible":"Polaris-Tabs__DisclosureTab--visible",DisclosureActivator:"Polaris-Tabs__DisclosureActivator",TabsMeasurer:"Polaris-Tabs__TabsMeasurer",NewTab:"Polaris-Tabs__NewTab",ActionListWrap:"Polaris-Tabs__ActionListWrap",Panel:"Polaris-Tabs__Panel","Panel-hidden":"Polaris-Tabs__Panel--hidden"};const Ve=40;function Ht({open:t,isModalLoading:l,name:s,onClose:b,onClickPrimaryAction:c,onClickSecondaryAction:o,helpText:m,viewNames:n}){const d=Se(),[u,x]=a.useState(s),p=a.useRef(null),f=n==null?void 0:n.some(i=>i.trim().toLowerCase()===u.trim().toLowerCase()),j=l||f||!u||u.length>Ve;a.useEffect(()=>{p.current&&t&&Ee(p.current)},[t]),a.useEffect(()=>{t&&x(s.slice(0,Ve))},[s,t]);const T=a.useCallback(i=>{x(i)},[]);async function E(){j||(await c(u),x(""),b())}function h(){o==null||o(),x(s),b()}return r.createElement(J,{open:t,onClose:b,title:d.translate("Polaris.Tabs.DuplicateModal.title"),primaryAction:{content:d.translate("Polaris.Tabs.DuplicateModal.create"),onAction:E,disabled:j},secondaryActions:[{content:d.translate("Polaris.Tabs.DuplicateModal.cancel"),onAction:h}],instant:!0},r.createElement(J.Section,null,r.createElement(qe,{onSubmit:E},r.createElement(He,null,r.createElement("div",{ref:p},r.createElement(Te,{label:d.translate("Polaris.Tabs.DuplicateModal.label"),value:u,onChange:T,autoComplete:"off",helpText:m,maxLength:Ve,showCharacterCount:!0,error:f?d.translate("Polaris.Tabs.DuplicateModal.errors.sameName",{name:u}):void 0}))))))}function Kt({open:t,isModalLoading:l,name:s,onClose:b,onClickPrimaryAction:c,onClickSecondaryAction:o,helpText:m,viewNames:n}){const d=Se(),[u,x]=a.useState(s),p=a.useRef(null),f=n==null?void 0:n.filter(i=>i!==s).some(i=>i.trim().toLowerCase()===u.trim().toLowerCase()),j=l||f||u===s||!u;a.useEffect(()=>{p.current&&t&&Ee(p.current)},[t]),a.useEffect(()=>{t&&x(s)},[s,t]);const T=a.useCallback(i=>{x(i)},[]);async function E(){j||(await c(u),x(""),b())}function h(){o==null||o(),x(s),b()}return r.createElement(J,{open:t,onClose:b,title:d.translate("Polaris.Tabs.RenameModal.title"),primaryAction:{content:d.translate("Polaris.Tabs.RenameModal.create"),onAction:E,disabled:j},secondaryActions:[{content:d.translate("Polaris.Tabs.RenameModal.cancel"),onAction:h}],instant:!0},r.createElement(J.Section,null,r.createElement(qe,{onSubmit:E},r.createElement(He,null,r.createElement("div",{ref:p},r.createElement(Te,{label:d.translate("Polaris.Tabs.RenameModal.label"),value:u,onChange:T,autoComplete:"off",helpText:m,maxLength:40,showCharacterCount:!0,error:f?d.translate("Polaris.Tabs.RenameModal.errors.sameName",{name:u}):void 0}))))))}const Be=a.forwardRef(({content:t,accessibilityLabel:l,badge:s,id:b,panelID:c,url:o,onAction:m,actions:n,disabled:d,isModalLoading:u,icon:x,siblingTabHasFocus:p,measuring:f,focused:j,selected:T,onToggleModal:E,onTogglePopover:h,viewNames:i,tabIndexOverride:A,disclosureZIndexOverride:C,onFocus:z},N)=>{const _=Se(),[Q,se]=a.useState(!1),[$,re]=a.useState(null),ee=a.useRef(T),O=a.useRef(!1),U=a.useRef(null);a.useEffect(()=>{h(Q)},[Q,h]),a.useEffect(()=>{E(!!$)},[$,E]),a.useEffect(()=>()=>{E(!1),h(!1)},[E,h]),a.useEffect(()=>{if(f)return;(j||document.activeElement&&document.activeElement.id===b)&&T&&c!=null&&!O.current&&(tt(c),O.current=!0),T&&!ee.current&&c!=null?tt(c):j&&U.current!=null&&$==null&&!d&&Ee(U.current),ee.current=T},[j,b,t,f,c,T,$,d]);let H;T&&!p&&!f||j&&!f?H=0:H=-1,A!=null&&(H=A);const Z=n==null?void 0:n.find(D=>D.type==="rename"),R=n==null?void 0:n.find(D=>D.type==="duplicate"),L=n==null?void 0:n.find(D=>D.type==="delete"),w=a.useCallback(()=>{n!=null&&n.length&&se(D=>!D)},[n]),M=a.useCallback(()=>{d||(T?w():m==null||m())},[T,m,w,d]),G=D=>{re(D)},W=()=>{re(null)},V=a.useCallback(async D=>{var oe;await((oe=Z==null?void 0:Z.onPrimaryAction)==null?void 0:oe.call(Z,D)),setTimeout(()=>{U.current&&Ee(U.current)},250)},[Z]),me=a.useCallback(async()=>{var D;await((D=L==null?void 0:L.onPrimaryAction)==null?void 0:D.call(L,t)),W()},[L,t]),be=a.useCallback(async D=>{var oe;await((oe=R==null?void 0:R.onPrimaryAction)==null?void 0:oe.call(R,D))},[R]),ge={rename:{icon:Nt,content:_.translate("Polaris.Tabs.Tab.rename")},duplicate:{icon:ht,content:_.translate("Polaris.Tabs.Tab.duplicate")},edit:{icon:mt,content:_.translate("Polaris.Tabs.Tab.edit")},"edit-columns":{icon:gt,content:_.translate("Polaris.Tabs.Tab.editColumns")},delete:{icon:Ke,content:_.translate("Polaris.Tabs.Tab.delete"),destructive:!0}},fe=n==null?void 0:n.map(({type:D,onAction:oe,onPrimaryAction:vt,...De})=>{const Oe=!D.includes("edit");return{...ge[D],...De,onAction:()=>{oe==null||oe(t),w(),Oe&&G(D)}}}),te=a.useCallback(D=>{D.key===" "&&(D.preventDefault(),M())},[M]),Pe=de(P.TabContainer,T&&P.Underline),xe=d||T?void 0:o,S=xe?it:ct,X=de(P.Tab,x&&P["Tab-iconOnly"],Q&&P["Tab-popoverActive"],T&&P["Tab-active"],T&&(n==null?void 0:n.length)&&P["Tab-hasActions"]),le=s?r.createElement(q,{tone:T?void 0:"new"},s):null,Y=T&&(n!=null&&n.length)?r.createElement("div",{className:de(P.IconWrap)},r.createElement(he,{source:Fe})):null,ae=r.createElement(S,{id:b,className:X,tabIndex:H,"aria-selected":T,"aria-controls":c,"aria-label":l,role:A==null?"tab":void 0,disabled:d,url:xe,onFocus:z,onMouseUp:Pt,onClick:M,onKeyDown:te},r.createElement(F,{gap:"200",align:"center",blockAlign:"center",wrap:!1},r.createElement(v,{as:"span",variant:"bodySm",fontWeight:"medium"},x??t),le),Y),Ae=!T||!(n!=null&&n.length),ye=Z?r.createElement(Kt,{name:t,open:$==="rename",onClose:W,onClickPrimaryAction:V,isModalLoading:u,viewNames:i}):null,We=R?r.createElement(Ht,{open:$==="duplicate",name:_.translate("Polaris.Tabs.Tab.copy",{name:t}),onClose:W,onClickPrimaryAction:be,isModalLoading:u,viewNames:i||[]}):null,_e=L?r.createElement(J,{open:$==="delete",onClose:W,primaryAction:{content:_.translate("Polaris.Tabs.Tab.deleteModal.delete"),onAction:me,destructive:!0,disabled:u},secondaryActions:[{content:_.translate("Polaris.Tabs.Tab.deleteModal.cancel"),onAction:W}],title:_.translate("Polaris.Tabs.Tab.deleteModal.title"),instant:!0},r.createElement(J.Section,null,_.translate("Polaris.Tabs.Tab.deleteModal.description",{viewName:t}))):null,Me=Ae||d?ae:r.createElement(r.Fragment,null,r.createElement(Ze,{active:Q,activator:ae,autofocusTarget:"first-node",onClose:w,zIndexOverride:C},r.createElement("div",{className:P.ActionListWrap},r.createElement(ot,{actionRole:"menuitem",items:fe}))),ye,We,_e);return x?Me:r.createElement("li",{className:Pe,ref:qt([U,N]),role:"presentation"},Me)});Be.displayName="Tab";function tt(t){const l=document.getElementById(t);l&&l.focus({preventScroll:!0})}function qt(t){return l=>{for(const s of t)s!=null&&(s.current=l)}}function at({hidden:t,id:l,tabID:s,children:b}){const c=de(P.Panel,t&&P["Panel-hidden"]);return r.createElement("div",{className:c,id:l,role:"tabpanel","aria-labelledby":s,tabIndex:-1},b)}const Jt=a.memo(function({id:l,focused:s,children:b,url:c,accessibilityLabel:o,onClick:m=Xt}){const n=a.useRef(null);a.useEffect(()=>{const p=n.current;p&&p instanceof HTMLElement&&s&&requestAnimationFrame(()=>{p.focus()})},[n,s]);const d=de(P.Item),u={id:l,ref:n,onClick:m,className:d,"aria-selected":!1,"aria-label":o},x=c?r.createElement(it,Object.assign({},u,{url:c}),b):r.createElement("button",Object.assign({},u,{ref:n,type:"button"}),b);return r.createElement("li",null,x)});function Xt(){}function Yt({focusIndex:t,disclosureTabs:l,onClick:s=nt,onKeyPress:b=nt}){const c=l.map(({id:o,content:m,...n},d)=>r.createElement(Jt,Object.assign({key:o},n,{id:o,focused:d===t,onClick:s.bind(null,o)}),m));return r.createElement("ul",{className:P.List,onKeyDown:Qt,onKeyUp:b},c)}function nt(){}function Qt(t){const{key:l}=t;(l==="ArrowLeft"||l==="ArrowRight")&&(t.preventDefault(),t.stopPropagation())}const st=40;function ea({activator:t,open:l,onClose:s,onClickPrimaryAction:b,onClickSecondaryAction:c,viewNames:o}){const m=Se(),[n,d]=a.useState(""),[u,x]=a.useState(!1),p=a.useRef(null),f=Gt(),j=o.some(A=>A.trim().toLowerCase()===n.trim().toLowerCase()),T=!n||j||u||n.length>st;a.useEffect(()=>{if(!(!p.current||f)&&l){Ee(p.current);const A=setTimeout(()=>{p.current&&Ee(p.current)},50);return()=>clearTimeout(A)}},[l,f]);const E=a.useCallback(A=>{d(A)},[]);async function h(){j||T||(x(!0),await b(n),x(!1),d(""),s())}function i(){c==null||c(),d(""),s()}return r.createElement(J,{activator:t,open:l,onClose:s,title:m.translate("Polaris.Tabs.CreateViewModal.title"),primaryAction:{content:m.translate("Polaris.Tabs.CreateViewModal.create"),onAction:h,disabled:T},secondaryActions:[{content:m.translate("Polaris.Tabs.CreateViewModal.cancel"),onAction:i}]},r.createElement(J.Section,null,r.createElement(qe,{onSubmit:h},r.createElement(He,null,r.createElement("div",{ref:p},r.createElement(Te,{label:m.translate("Polaris.Tabs.CreateViewModal.label"),value:n,onChange:E,autoComplete:"off",maxLength:st,showCharacterCount:!0,error:j?m.translate("Polaris.Tabs.CreateViewModal.errors.sameName",{name:n}):void 0}))))))}const ta=a.memo(function({selected:l,tabs:s,activator:b,tabToFocus:c,siblingTabHasFocus:o,handleMeasurement:m}){const n=a.useRef(null),d=a.useRef(null),u=a.useCallback(()=>{d.current&&cancelAnimationFrame(d.current),d.current=requestAnimationFrame(()=>{if(!n.current)return;const f=n.current.offsetWidth-20-28,j=n.current.children,E=Array.from(j).map(i=>Math.ceil(i.getBoundingClientRect().width)+4),h=E.pop()||0;m({containerWidth:f,disclosureWidth:h,hiddenTabWidths:E})})},[m]);a.useEffect(()=>{u()},[u,s]),Rt(()=>{});const x=s.map((f,j)=>r.createElement(Be,{measuring:!0,key:`$${f.id}Hidden`,id:`${f.id}Measurer`,siblingTabHasFocus:o,focused:j===c,selected:j===l,url:f.url,content:f.content,onTogglePopover:rt,onToggleModal:rt})),p=de(P.Tabs,P.TabsMeasurer);return lt("resize",u),r.createElement("div",{className:p,ref:n},x,b)});function rt(){}const aa="create-new-view",na=({tabs:t,children:l,selected:s,newViewAccessibilityLabel:b,canCreateNewView:c,disabled:o,onCreateNewView:m,onSelect:n,fitted:d,disclosureText:u,disclosureZIndexOverride:x})=>{const p=Se(),{mdDown:f}=$t(),j=a.useRef(null),T=a.useRef(null),E=a.useRef(null),[h,i]=a.useReducer((g,y)=>({...g,...y}),{disclosureWidth:0,containerWidth:1/0,tabWidths:[],visibleTabs:[],hiddenTabs:[],showDisclosure:!1,tabToFocus:-1,isNewViewModalActive:!1,modalSubmitted:!1,isTabsFocused:!1,isTabPopoverOpen:!1,isTabModalOpen:!1}),{tabToFocus:A,visibleTabs:C,hiddenTabs:z,showDisclosure:N,isNewViewModalActive:_,modalSubmitted:Q,disclosureWidth:se,tabWidths:$,containerWidth:re,isTabsFocused:ee,isTabModalOpen:O,isTabPopoverOpen:U}=h,H=Qe(O),Z=Qe(U);a.useEffect(()=>{H&&!O?i({isTabsFocused:!0,tabToFocus:s}):Z&&!U&&!O&&i({isTabsFocused:!0,tabToFocus:s})},[Z,U,H,O,s,A]);const R=a.useCallback(g=>i({isTabPopoverOpen:g}),[]),L=a.useCallback(g=>i({isTabModalOpen:g}),[]),w=()=>{i({isNewViewModalActive:!1})},M=async g=>{if(!m)return!1;const y=await(m==null?void 0:m(g));return y&&i({modalSubmitted:!0}),y},G=()=>{i({isNewViewModalActive:!0})},W=a.useCallback(g=>{const y=t.find(K=>K.id===g);if(y==null)return null;const B=t.indexOf(y);n==null||n(B)},[t,n]),V=a.useCallback((g,y)=>{const B=()=>{var ie;W(g.id),(ie=g.onAction)==null||ie.call(g)},K=t.map(({content:ie})=>ie),ue=g.panelID||`${g.id}-panel`;return r.createElement(Be,Object.assign({},g,{key:`${y}-${g.id}`,id:g.id,panelID:l?ue:void 0,disabled:o||g.disabled,siblingTabHasFocus:A>-1,focused:y===A,selected:y===s,onAction:B,accessibilityLabel:g.accessibilityLabel,url:g.url,content:g.content,onToggleModal:L,onTogglePopover:R,viewNames:K,disclosureZIndexOverride:x,ref:y===s?E:null}))},[o,t,l,s,A,x,W,L,R]),me=a.useCallback(g=>{const y=g.target,B=y.classList.contains(P.Item),K=y.closest("[data-tabs-focus-catchment]")||B;y.classList.contains(P.DisclosureActivator)||!K||i({isTabsFocused:!0})},[]),be=a.useCallback(g=>{var Re,pe,ce;const y=g.target,B=g.relatedTarget,K=(Re=B==null?void 0:B.closest)==null?void 0:Re.call(B,`.${P.Tabs}`),ue=(ce=(pe=y==null?void 0:y.classList)==null?void 0:pe.contains)==null?void 0:ce.call(pe,P.Tab),ie=B==null?void 0:B.classList.contains(P.Item);if(!B&&!O&&!ue&&!ie){i({tabToFocus:-1});return}if(!K&&!O&&!ue&&!ie){i({tabToFocus:-1});return}i({isTabsFocused:!1})},[O]),ge=g=>{if(U||O||_)return;const{key:y}=g;(y==="ArrowLeft"||y==="ArrowRight")&&(g.preventDefault(),g.stopPropagation())};a.useEffect(()=>{const{visibleTabs:g,hiddenTabs:y}=et(t,s,se,$,re);i({visibleTabs:g,hiddenTabs:y})},[re,se,t,s,$,i]);const fe=a.useCallback(()=>{var y;const g=(y=E.current)==null?void 0:y.querySelector(`.${P["Tab-active"]}`);g&&le(g.offsetLeft)},[]);a.useEffect(()=>{f&&fe()},[fe,s,f]),a.useEffect(()=>{ee&&!N&&i({tabToFocus:s})},[ee,s,i,N]);const te=g=>{const{showDisclosure:y,visibleTabs:B,hiddenTabs:K,tabToFocus:ue,isNewViewModalActive:ie}=h;if(O||U||ie)return;const Re=g.key,pe=y||f?B.concat(K):[...B];let ce=pe.indexOf(ue);Re==="ArrowRight"&&(ce+=1,ce===pe.length&&(ce=0)),Re==="ArrowLeft"&&(ce===-1||ce===0?ce=pe.length-1:ce-=1);const Xe=pe[ce];Xe!=null&&i({tabToFocus:Xe})},Pe=()=>{i({showDisclosure:!N,tabToFocus:z[0]})},xe=()=>{i({showDisclosure:!1})},S=a.useCallback(g=>{const{hiddenTabWidths:y,containerWidth:B,disclosureWidth:K}=g,{visibleTabs:ue,hiddenTabs:ie}=et(t,s,K,y,B);i({visibleTabs:ue,hiddenTabs:ie,disclosureWidth:K,containerWidth:B,tabWidths:y})},[t,s,i]),X=g=>{W(g),xe(),i({isTabsFocused:!0})},le=g=>{setTimeout(()=>{var y,B;if(j.current&&typeof j.current.scroll=="function"){const K=((y=T==null?void 0:T.current)==null?void 0:y.offsetLeft)||0;(B=j==null?void 0:j.current)==null||B.scroll({left:g-K})}},0)},Y=b||p.translate("Polaris.Tabs.newViewAccessibilityLabel"),ae=f?[...C,...z]:C,Ae=ae.sort((g,y)=>g-y).filter(g=>t[g]).map(g=>V(t[g],g)),ye=C.length<t.length&&!f,We=de(P.Tabs,d&&P.fitted,ye&&P.fillSpace),_e=de(P.Wrapper,c&&P.WrapperWithNewButton),Me=de(P.DisclosureTab,ye&&P["DisclosureTab-visible"]),D=de(P.DisclosureActivator),oe=r.createElement(r.Fragment,null,r.createElement(v,{as:"span",variant:"bodySm",fontWeight:"medium"},u??p.translate("Polaris.Tabs.toggleTabsLabel")),r.createElement("div",{className:de(P.IconWrap,ye&&N&&P["IconWrap-open"])},r.createElement(he,{source:Fe,tone:"subdued"}))),De=r.createElement(ct,{type:"button",className:D,onClick:Pe,"aria-label":u??p.translate("Polaris.Tabs.toggleTabsLabel"),disabled:o},oe),Oe=z.map(g=>t[g]),xt=t.map(({content:g})=>g),jt=r.createElement(ta,{tabToFocus:A,activator:De,selected:s,tabs:t,siblingTabHasFocus:A>-1,handleMeasurement:S}),Je=r.createElement(Be,{id:aa,content:Y,actions:[],onAction:G,onFocus:()=>{Q&&i({tabToFocus:s,modalSubmitted:!1})},icon:r.createElement(he,{source:Lt,accessibilityLabel:Y}),disabled:o,onTogglePopover:R,onToggleModal:L,tabIndexOverride:0}),Tt=l?t.map((g,y)=>s===y?r.createElement(at,{id:t[y].panelID||`${t[y].id}-panel`,tabID:t[y].id,key:t[y].id},l):r.createElement(at,{id:t[y].panelID||`${t[y].id}-panel`,tabID:t[y].id,key:t[y].id,hidden:!0})):null;return r.createElement("div",{className:P.Outer},r.createElement(I,{padding:{md:"200"}},jt,r.createElement("div",{className:_e,ref:j},r.createElement("div",{className:P.ButtonWrapper,ref:T},r.createElement("ul",{role:Ae.length>0?"tablist":void 0,className:We,onFocus:me,onBlur:be,onKeyDown:ge,onKeyUp:te,"data-tabs-focus-catchment":!0},Ae,f||ae.length===0?null:r.createElement("li",{className:Me,role:"presentation"},r.createElement(Ze,{preferredPosition:"below",preferredAlignment:"left",activator:De,active:ye&&N,onClose:xe,autofocusTarget:"first-node",zIndexOverride:x},r.createElement(Yt,{focusIndex:z.indexOf(A),disclosureTabs:Oe,onClick:X,onKeyPress:te})))),c&&ae.length>0?r.createElement("div",{className:P.NewTab},r.createElement(ea,{open:_,onClose:w,onClickPrimaryAction:M,viewNames:xt,activator:o?Je:r.createElement("div",null,r.createElement(yt,{content:p.translate("Polaris.Tabs.newViewTooltip"),preferredPosition:"above",hoverDelay:400,zIndexOverride:x},Je))})):null))),Tt)};function sa({totalReviews:t,averageRating:l}){const[s,b]=a.useState(!1),c=[{value:l,label:"Average Rating",icon:Ce,valueTone:"success",iconColor:"success"},{value:t,label:"Total Reviews",icon:pt,valueTone:"subdued",iconColor:"interactive"}];return e.jsx(ke,{background:"bg-surface-secondary",children:e.jsxs(k,{gap:"500",children:[e.jsxs(F,{align:"space-between",blockAlign:"center",children:[e.jsx(v,{as:"h1",variant:"headingLg",children:"Review Summary"}),e.jsx(ne,{variant:"plain",icon:s?Fe:dt,onClick:()=>b(!s),accessibilityLabel:s?"Expand summary":"Collapse summary"})]}),!s&&e.jsx(Le,{columns:2,gap:"600",children:c.map((o,m)=>e.jsx(I,{padding:"600",background:"bg-surface",borderRadius:"300",shadow:"400",children:e.jsxs(k,{gap:"300",align:"center",children:[e.jsx(I,{background:"bg-fill-secondary",borderRadius:"full",padding:"300",children:e.jsx(he,{source:o.icon,tone:o.iconColor})}),e.jsx(v,{as:"p",variant:"heading2xl",fontWeight:"semibold",alignment:"center",tone:o.valueTone,children:o.value}),e.jsx(v,{as:"p",variant:"bodyMd",tone:"subdued",alignment:"center",children:o.label})]})},m))})]})})}function ra(){const{reviews:t,totalReviews:l,averageRating:s,currentPage:b,reviewsPerPage:c,productSummaries:o,bundles:m,shopifyProducts:n}=kt();It();const[d]=At(),u=Mt();Ge();const x=Dt(),p=Ie(),f=Ie(),j=Ie(),[T,E]=a.useState(null),[h,i]=a.useState(!1),[A,C]=a.useState(""),[z,N]=a.useState(!1),[_,Q]=a.useState(0),[se,$]=a.useState(null),[re,ee]=a.useState(null),[O,U]=a.useState("highest-rating"),H=p.state==="submitting",Z=f.state==="submitting"||f.state==="loading",R=j.state==="submitting",L=x.state==="submitting",w=Math.ceil(l/c),M=b<w,G=b>1,W=S=>{const X=new URLSearchParams(d);X.set("page",String(S)),u(`?${X.toString()}`)},V=a.useCallback(S=>{var le;const X=((le=S.target.files)==null?void 0:le[0])||null;E(X)},[]),me=a.useCallback(()=>{E(null);const S=document.getElementById("csv-file-input");S&&(S.value="")},[]),be=a.useCallback(()=>i(S=>!S),[]),ge=a.useCallback(()=>{const S=new FormData;S.append("actionType","export_csv"),p.submit(S,{method:"post"})},[p]),fe=a.useCallback(()=>{const S=new FormData;S.append("actionType","download_sample_csv"),j.submit(S,{method:"post"})},[j]),te=a.useCallback(()=>{if(!T){C("Please select a CSV file to import"),N(!0),i(!0);return}const S=new FormData;S.append("actionType","import_csv"),S.append("csvFile",T),f.submit(S,{method:"post",encType:"multipart/form-data"})},[T,f]);a.useEffect(()=>{var S,X;if((S=p.data)!=null&&S.csvData&&p.data.fileName){const le=new Blob([p.data.csvData],{type:"text/csv"}),Y=window.URL.createObjectURL(le),ae=document.createElement("a");ae.href=Y,ae.download=p.data.fileName,document.body.appendChild(ae),ae.click(),window.URL.revokeObjectURL(Y),document.body.removeChild(ae)}else(X=p.data)!=null&&X.error&&(C(p.data.error),N(!0),i(!0))},[p.data]),a.useEffect(()=>{var S;if((S=j.data)!=null&&S.csvData&&j.data.fileName){const X=new Blob([j.data.csvData],{type:"text/csv"}),le=window.URL.createObjectURL(X),Y=document.createElement("a");Y.href=le,Y.download=j.data.fileName,document.body.appendChild(Y),Y.click(),window.URL.revokeObjectURL(le),document.body.removeChild(Y)}},[j.data]),a.useEffect(()=>{if(f.data&&(C(f.data.message||f.data.error||"Import completed."),N(!f.data.success),i(!0),f.data.success)){E(null);const S=document.getElementById("csv-file-input");S&&(S.value="")}},[f.data]);const Pe=a.useCallback(S=>{Q(S),$(null),ee(null)},[]),xe=a.useCallback(S=>{U(S)},[]);return{reviews:t,totalReviews:l,averageRating:s,currentPage:b,reviewsPerPage:c,productSummaries:o,bundles:m,shopifyProducts:n,csvFile:T,activeToast:h,toastMessage:A,toastError:z,selectedTab:_,selectedBundleId:se,selectedProductId:re,sortOption:O,isSubmitting:L,isExporting:H,isImporting:Z,isDownloadingSample:R,pageCount:w,hasNext:M,hasPrevious:G,handlePageChange:W,handleFileChange:V,handleRemoveFile:me,toggleActiveToast:be,handleExportCSV:ge,handleDownloadSampleCSV:fe,handleImportCSV:te,handleTabChange:Pe,handleSortChange:xe,setSelectedBundleId:$,setSelectedProductId:ee,setActiveToast:i}}function la({isExporting:t,isImporting:l,isDownloadingSample:s,handleExportCSV:b,csvFile:c,handleFileChange:o,handleRemoveFile:m,handleImportCSV:n,handleDownloadSampleCSV:d}){const[u,x]=a.useState(!1);return e.jsx(ke,{children:e.jsxs(k,{gap:"600",children:[e.jsxs(F,{align:"space-between",blockAlign:"center",children:[e.jsx(v,{as:"h2",variant:"headingXl",fontWeight:"bold",children:"Bulk Review Management"}),e.jsx(ne,{variant:"plain",icon:u?Fe:dt,onClick:()=>x(!u),accessibilityLabel:u?"Expand bulk management":"Collapse bulk management"})]}),!u&&e.jsxs(e.Fragment,{children:[e.jsx(Bt,{tone:"info",children:e.jsxs(k,{gap:"200",children:[e.jsx(v,{as:"p",variant:"bodyLg",children:"Export your reviews to CSV for backup or analysis, or import reviews from a CSV or Excel file. Download the sample template to see the required format."}),e.jsxs(v,{as:"p",variant:"bodyMd",tone:"subdued",children:[e.jsx("strong",{children:"Important:"})," When importing, reviews for existing products will be imported successfully. Reviews for non-existent products will be skipped with a warning message."]})]})}),e.jsx(je,{}),e.jsxs(F,{gap:"800",align:"start",blockAlign:"center",children:[e.jsx("div",{style:{flex:1},children:e.jsxs(k,{gap:"400",children:[e.jsx(ne,{variant:"primary",onClick:b,disabled:t,icon:bt,fullWidth:!0,size:"large",children:t?"Exporting...":"Download CSV"}),e.jsx(v,{as:"p",variant:"bodyMd",tone:"subdued",alignment:"center",children:"Export all reviews as CSV file"})]})}),e.jsx("div",{style:{width:"1px",height:"100px",background:"var(--p-color-border-secondary)"}}),e.jsx("div",{style:{flex:1},children:e.jsxs(k,{gap:"400",children:[c?e.jsx(I,{width:"100%",children:e.jsx(I,{background:"bg-fill-success-secondary",borderRadius:"300",padding:"400",children:e.jsxs(F,{align:"space-between",blockAlign:"center",children:[e.jsxs(F,{gap:"300",blockAlign:"center",children:[e.jsx(I,{background:"bg-fill-success",borderRadius:"200",padding:"200",children:e.jsx(v,{as:"span",variant:"bodyLg",fontWeight:"bold",tone:"text-inverse",children:"âœ“"})}),e.jsxs(k,{gap:"100",children:[e.jsx(v,{as:"span",variant:"bodyLg",fontWeight:"bold",children:c.name}),e.jsxs(v,{as:"span",variant:"bodySm",tone:"subdued",children:[(c.size/1024).toFixed(2)," KB"]})]})]}),e.jsx(ne,{variant:"tertiary",onClick:m,tone:"critical",children:"Remove"})]})})}):e.jsx(I,{width:"100%",children:e.jsx("input",{id:"csv-file-input",type:"file",accept:".csv, .xls, .xlsx",onChange:o,style:{width:"100%",padding:"12px",border:"1px solid #c4cdd5",borderRadius:"8px",background:"transparent",cursor:"pointer",fontSize:"14px",marginBottom:"8px"}})}),e.jsx(ne,{variant:"primary",onClick:n,disabled:!c||l,fullWidth:!0,size:"large",children:l?"Importing...":"Upload & Import"})]})})]}),e.jsx(je,{}),e.jsx(F,{align:"center",children:e.jsx(ne,{variant:"tertiary",onClick:d,disabled:s,loading:s,children:"Download Sample CSV Template"})})]})]})})}const we={PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"},ve={SUCCESS:"success",CRITICAL:"critical",ATTENTION:"attention",WARNING:"warning"},oa={[we.APPROVED]:ve.SUCCESS,[we.REJECTED]:ve.CRITICAL,[we.PENDING]:ve.ATTENTION},ia={getByRating:t=>t>=4.5||t>=4?ve.SUCCESS:t>=3?ve.WARNING:(t>=2,ve.CRITICAL)},ca=[{label:"Pending",value:we.PENDING},{label:"Approved",value:we.APPROVED},{label:"Rejected",value:we.REJECTED}],da=[{label:"â­ 1 Star",value:"1"},{label:"â­â­ 2 Stars",value:"2"},{label:"â­â­â­ 3 Stars",value:"3"},{label:"â­â­â­â­ 4 Stars",value:"4"},{label:"â­â­â­â­â­ 5 Stars",value:"5"}];function ua({review:t,isOpen:l,isSubmitting:s,onClose:b,onSubmit:c}){const[o,m]=a.useState({title:"",content:"",rating:"5",author:"",email:"",status:"pending"}),[n,d]=a.useState(""),[u,x]=a.useState([]),[p,f]=a.useState([]);a.useEffect(()=>{t&&(m({title:t.title||"",content:t.content,rating:t.rating.toString(),author:t.author,email:t.email||"",status:t.status}),d(t.status),f(t.images||[]),x([]))},[t]);const j=a.useCallback(h=>{x(i=>[...i,h]),f(i=>i.filter(A=>A.id!==h))},[]),T=a.useCallback(()=>{if(!t)return;const h=new FormData;h.append("intent","edit"),h.append("title",o.title),h.append("content",o.content),h.append("rating",o.rating),h.append("author",o.author),h.append("email",o.email),h.append("status",n||o.status),u.forEach(i=>{h.append("imagesToRemove[]",i)}),c(h)},[t,o,n,u,c]),E=h=>ca.filter(i=>i.value!==h);return e.jsx(J,{open:l,onClose:b,title:"Edit Review",primaryAction:{content:"Save Changes",onAction:T,loading:s},secondaryActions:[{content:"Cancel",onAction:b}],children:e.jsx(J.Section,{children:e.jsxs(k,{gap:"500",children:[e.jsx(Te,{label:"Title",value:o.title,onChange:h=>m(i=>({...i,title:h})),autoComplete:"off",disabled:s}),e.jsx(Te,{label:"Review Content",value:o.content,onChange:h=>m(i=>({...i,content:h})),multiline:4,autoComplete:"off",disabled:s}),e.jsxs(Le,{columns:2,gap:"400",children:[e.jsx(Ye,{label:"Rating",options:[...da],value:o.rating,onChange:h=>m(i=>({...i,rating:h})),disabled:s}),e.jsx(Ye,{label:"Change Status",options:[...E(o.status)],value:n,onChange:d,disabled:s,helpText:`Current status: ${o.status.charAt(0).toUpperCase()+o.status.slice(1)}`,placeholder:"Select new status"})]}),e.jsxs(Le,{columns:2,gap:"400",children:[e.jsx(Te,{label:"Author Name",value:o.author,onChange:h=>m(i=>({...i,author:h})),autoComplete:"off",disabled:s}),e.jsx(Te,{label:"Email",value:o.email,onChange:h=>m(i=>({...i,email:h})),type:"email",autoComplete:"off",disabled:s})]}),e.jsxs(I,{children:[e.jsx(v,{as:"h4",variant:"headingSm",fontWeight:"medium",children:"Review Images"}),e.jsxs(k,{gap:"400",children:[p.length>0?e.jsxs(I,{children:[e.jsxs(v,{as:"p",variant:"bodySm",fontWeight:"medium",tone:"subdued",children:["Images (",p.length,")",u.length>0&&e.jsxs(v,{as:"span",variant:"bodySm",tone:"critical",children:[" ","(",u.length," marked for removal)"]})]}),e.jsx(F,{gap:"300",wrap:!0,children:p.map((h,i)=>e.jsxs("div",{style:{position:"relative",textAlign:"right",borderRadius:"12px",overflow:"hidden",border:u.includes(h.id)?"3px solid var(--p-color-border-critical)":"1px solid var(--p-color-border-subdued)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease-in-out",opacity:u.includes(h.id)?.4:1,cursor:"default"},children:[e.jsx("button",{type:"button",onClick:()=>j(h.id),disabled:s,style:{position:"absolute",top:"8px",right:"8px",minHeight:"24px",height:"24px",width:"24px",padding:"0",borderRadius:"50%",fontSize:"12px",fontWeight:"bold",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,visibility:u.includes(h.id)?"hidden":"visible",backgroundColor:"var(--p-color-bg-fill-critical)",color:"var(--p-color-text-on-color)",border:"none",cursor:s?"not-allowed":"pointer"},children:"Ã—"}),e.jsx("img",{src:h.url,alt:h.altText||`Review image ${i+1}`,style:{width:"100px",height:"100px",objectFit:"cover",display:"block"}})]},h.id))})]}):e.jsx(I,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsx(v,{as:"p",variant:"bodySm",tone:"subdued",alignment:"center",children:"No images attached to this review."})}),e.jsx(I,{padding:"200",children:e.jsx(v,{as:"p",variant:"bodySm",tone:"subdued",alignment:"center",children:"You can only remove existing images from this editor."})})]})]}),s&&e.jsx(I,{padding:"300",background:"bg-surface-secondary",borderRadius:"200",children:e.jsx(v,{as:"p",variant:"bodySm",tone:"subdued",alignment:"center",children:"ðŸ’¾ Saving changes..."})})]})})})}function pa({review:t,isOpen:l,isSubmitting:s,onClose:b,onConfirm:c}){return e.jsx(J,{open:l,onClose:b,title:"Delete Review",primaryAction:{content:"Delete Review",onAction:c,destructive:!0,loading:s},secondaryActions:[{content:"Cancel",onAction:b}],children:e.jsx(J.Section,{children:e.jsxs(k,{gap:"400",children:[e.jsx(v,{as:"p",variant:"bodyMd",children:"Are you sure you want to delete this review? This action cannot be undone."}),t&&e.jsxs(I,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:[e.jsx(v,{as:"p",variant:"bodySm",fontWeight:"medium",children:t.title||"No Title"}),e.jsxs(v,{as:"p",variant:"bodySm",tone:"subdued",children:["by ",t.author," â€¢ Rating: ",t.rating,"/5"]}),e.jsxs(v,{as:"p",variant:"bodySm",tone:"subdued",children:[t.content.substring(0,100),"..."]})]}),s&&e.jsx(I,{padding:"200",children:e.jsx(v,{as:"p",variant:"bodySm",tone:"subdued",alignment:"center",children:"Deleting review..."})})]})})})}function ha({review:t,isSubmitting:l,isStatusChanging:s,onEdit:b,onDelete:c,onChangeStatus:o}){const m=n=>{try{const d=new Date(n);return isNaN(d.getTime())?"":d.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return""}};return e.jsx(I,{padding:"600",background:"bg-surface",borderRadius:"400",onClick:()=>b(t),style:{padding:"16px",cursor:"pointer",transition:"all 0.2s ease-in-out",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",border:"1px solid var(--p-color-border-subdued)"},onMouseEnter:n=>{n.currentTarget.style.backgroundColor="var(--p-color-bg-surface-hover)",n.currentTarget.style.boxShadow="0 3px 8px rgba(0, 0, 0, 0.12)",n.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:n=>{n.currentTarget.style.backgroundColor="var(--p-color-bg-surface)",n.currentTarget.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.1)",n.currentTarget.style.transform="translateY(0)"},children:e.jsxs(k,{gap:"500",children:[e.jsxs(F,{align:"space-between",blockAlign:"start",children:[e.jsxs(k,{gap:"300",children:[e.jsxs(F,{gap:"300",blockAlign:"center",wrap:!1,children:[e.jsx(v,{as:"h3",variant:"headingMd",fontWeight:"semibold",children:t.title||"Untitled Review"}),e.jsxs(F,{gap:"100",blockAlign:"center",children:[e.jsx(he,{source:Ce,tone:"warning"}),e.jsx(v,{as:"span",variant:"bodyMd",fontWeight:"medium",children:`${t.rating}/5`})]}),e.jsx(q,{tone:oa[t.status]||"attention",size:"large",children:(t.status||"pending").charAt(0).toUpperCase()+(t.status||"pending").slice(1)}),t.isBundleReview&&e.jsx(q,{tone:"info",size:"large",children:"Syndicated"})]}),e.jsxs(v,{as:"p",variant:"bodySm",tone:"subdued",children:["by ",t.author," â€¢ ",m(t.createdAt||""),t.email&&t.email!==""&&` â€¢ ${t.email}`]})]}),e.jsxs(Ct,{children:[((t.status||"pending")==="pending"||(t.status||"pending")==="rejected")&&e.jsx(ne,{size:"slim",variant:"primary",onClick:n=>{n.stopPropagation(),o(t.id,"approved")},disabled:s,loading:s,children:"Approve"}),(t.status||"pending")==="approved"&&e.jsx(ne,{size:"slim",tone:"critical",variant:"primary",onClick:n=>{n.stopPropagation(),o(t.id,"rejected")},disabled:s,loading:s,children:"Reject"}),e.jsx(ne,{icon:Ke,onClick:n=>{n.stopPropagation(),c(t)},variant:"tertiary",tone:"critical",size:"slim",disabled:l,children:"Delete"})]})]}),e.jsx(I,{paddingBlockStart:"200",children:e.jsx(v,{as:"p",variant:"bodyLg",tone:"subdued",lineHeight:"1.6",children:t.content})}),t.images&&t.images.length>0&&e.jsxs(I,{paddingBlockStart:"400",children:[e.jsxs(v,{as:"p",variant:"bodySm",fontWeight:"medium",tone:"subdued",children:["Images (",t.images.length,")"]}),e.jsx(F,{gap:"300",wrap:!0,children:t.images.map((n,d)=>e.jsx(I,{style:{borderRadius:"8px",overflow:"hidden",border:"1px solid var(--p-color-border-subdued)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:e.jsx("img",{src:n.url,alt:n.altText||`Review image ${d+1}`,style:{width:"80px",height:"80px",objectFit:"cover",display:"block"}})},n.id||d))})]})]})})}function Ue({reviews:t,externalSubmit:l,onReviewsUpdate:s,actionSource:b="individual"}){Ge();const c=Ie(),o=Ie(),[m,n]=a.useState(null),[d,u]=a.useState(null),[x,p]=a.useState(null);a.useEffect(()=>{const C=c.data;c.state==="idle"&&C&&(C.success?(p(null),m&&n(null),d&&u(null),s&&setTimeout(s,100)):C.error&&p(C.error))},[c.state,c.data,m,d,s]),a.useEffect(()=>{const C=o.data;o.state==="idle"&&C&&(C.success?(p(null),s&&setTimeout(s,100)):C.error&&p(C.error))},[o.state,o.data,s]);const f=a.useCallback((C,z)=>{const N=new FormData;N.append("status",z),N.append("actionSource",b),N.append("reviewId",C),o.submit(N,{method:"post",action:`/app/reviews/${C}/status`})},[b,o]),j=a.useCallback(C=>{n(C),p(null)},[]),T=a.useCallback(C=>{u(C),p(null)},[]),E=a.useCallback(C=>{m&&(C.append("actionSource",b),C.append("reviewId",m.id),c.submit(C,{method:"post",action:`/app/reviews/${m.id}/actions`}))},[m,c,b]),h=a.useCallback(()=>{if(!d)return;const C=new FormData;C.append("intent","delete"),C.append("actionSource",b),C.append("reviewId",d.id),c.submit(C,{method:"post",action:`/app/reviews/${d.id}/actions`})},[d,c,b]),i=a.useCallback(()=>{n(null),p(null)},[]),A=a.useCallback(()=>{u(null),p(null)},[]);return e.jsxs(k,{gap:"600",children:[x&&e.jsx(I,{padding:"400",children:e.jsx(wt,{message:x,fieldID:"review-error"})}),e.jsx(ua,{review:m,isOpen:!!m,isSubmitting:c.state==="submitting",onClose:i,onSubmit:E}),e.jsx(pa,{review:d,isOpen:!!d,isSubmitting:c.state==="submitting",onClose:A,onConfirm:h}),t&&t.length>0?e.jsx(k,{gap:"500",children:t.map(C=>{var z,N;return e.jsx(ha,{review:C,isSubmitting:c.state!=="idle"&&((z=c.formData)==null?void 0:z.get("reviewId"))===C.id,isStatusChanging:o.state!=="idle"&&((N=o.formData)==null?void 0:N.get("reviewId"))===C.id,onEdit:j,onDelete:T,onChangeStatus:f},C.id)})}):e.jsx("div",{style:{padding:"var(--p-space-1200)",background:"var(--p-color-bg-surface)",borderRadius:"var(--p-border-radius-400)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",border:"1px solid var(--p-color-border-subdued)"},children:e.jsx("p",{style:{paddingInline:"var(--p-space-400)",textAlign:"center"},children:e.jsx(v,{as:"span",variant:"bodyLg",fontWeight:"medium",tone:"subdued",children:"No reviews yet. Be the first to review!"})})})]})}function ma({productSummaries:t,actionSource:l="individual"}){const[s,b]=a.useState(!1),[c,o]=a.useState([]),[m,n]=a.useState(""),d=Ge(),u=a.useCallback(f=>{o(f.individualReviews),n(f.productName),b(!0)},[]),x=a.useCallback(()=>{b(!1),o([]),n("")},[]),p=f=>f.filter(j=>j.status==="pending").length;return e.jsxs(k,{gap:"400",children:[t.length>0?e.jsx(ke,{padding:"0",children:e.jsx($e,{resourceName:{singular:"product",plural:"products"},items:t,renderItem:f=>{const{productId:j,productName:T,productImageUrl:E,averageRating:h,totalReviews:i,individualReviews:A}=f,C=p(A);return e.jsx(ze,{id:j,url:"#",media:e.jsx(I,{paddingInlineEnd:"200",children:e.jsx(ut,{source:E||Vt.IMAGES.getPlaceholderUrl(T.split(" ")[0]),alt:`Image of ${T}`,size:"medium"})}),accessibilityLabel:`View reviews for ${T}`,onClick:()=>u(f),children:e.jsxs(Le,{columns:"1fr auto",gap:"400",alignItems:"center",children:[e.jsxs(k,{gap:"200",children:[e.jsx(v,{as:"h3",variant:"bodyLg",fontWeight:"semibold",children:T}),e.jsxs(F,{gap:"300",align:"start",blockAlign:"center",children:[e.jsxs(F,{gap:"100",align:"center",children:[e.jsx(he,{source:Ce,tone:"warning"}),e.jsx(v,{as:"span",variant:"bodyMd",fontWeight:"medium",children:h}),e.jsx(v,{as:"span",variant:"bodyMd",tone:"subdued",children:"/5"})]}),e.jsx(v,{as:"span",variant:"bodyMd",tone:"subdued",children:"â€¢"}),e.jsxs(v,{as:"span",variant:"bodyMd",tone:"subdued",children:[i," review",i!==1?"s":""]}),C>0&&e.jsxs(e.Fragment,{children:[e.jsx(v,{as:"span",variant:"bodyMd",tone:"subdued",children:"â€¢"}),e.jsx(q,{tone:"attention",size:"small",children:`${C} pending`})]})]})]}),e.jsx(q,{tone:ia.getByRating(parseFloat(h)),size:"large",children:h})]})})}})}):e.jsx(ke,{padding:"600",children:e.jsx(I,{paddingBlockStart:"400",paddingBlockEnd:"400",children:e.jsxs(k,{gap:"400",align:"center",children:[e.jsx("div",{style:{background:"var(--p-color-bg-fill-tertiary)",borderRadius:"var(--p-border-radius-400)",padding:"var(--p-space-400)",marginBottom:"var(--p-space-200)"},children:e.jsx(he,{source:Ce,tone:"subdued"})}),e.jsx(v,{as:"p",variant:"bodyLg",alignment:"center",tone:"subdued",children:"No products with reviews yet."}),e.jsx(v,{as:"p",variant:"bodyMd",alignment:"center",tone:"subdued",children:"Customer reviews will appear here once they start coming in."})]})})}),e.jsx(J,{activator:e.jsx("div",{style:{display:"none"}}),open:s,onClose:x,title:e.jsxs(F,{align:"space-between",blockAlign:"center",gap:"400",children:[e.jsxs(F,{gap:"200",align:"center",children:[e.jsx(v,{as:"h2",variant:"headingLg",children:m}),e.jsxs(v,{as:"p",variant:"bodyMd",tone:"subdued",children:["â€¢ Customer Reviews (",c.length,")"]})]}),c.length>0&&e.jsx(q,{tone:"attention",children:`${p(c)} pending`})]}),size:"large",primaryAction:{content:"Close",onAction:x},children:e.jsx(J.Section,{children:e.jsx(k,{gap:"400",children:c.length>0?e.jsx(Ue,{reviews:c,externalSubmit:d,onReviewsUpdate:x,actionSource:l}):e.jsx(ke,{padding:"600",children:e.jsx(I,{paddingBlockStart:"400",paddingBlockEnd:"400",children:e.jsxs(k,{gap:"400",align:"center",children:[e.jsx("div",{style:{background:"var(--p-color-bg-fill-tertiary)",borderRadius:"var(--p-border-radius-400)",padding:"var(--p-space-400)",marginBottom:"var(--p-space-200)"},children:e.jsx(he,{source:Ce,tone:"subdued"})}),e.jsx(v,{as:"p",variant:"bodyLg",alignment:"center",tone:"subdued",children:"No reviews available for this product."}),e.jsx(v,{as:"p",variant:"bodyMd",alignment:"center",tone:"subdued",children:"Check back later for customer feedback."})]})})})})})})]})}function ba({selectedTab:t,handleTabChange:l,totalReviews:s,reviews:b,pageCount:c,currentPage:o,hasPrevious:m,hasNext:n,handlePageChange:d,productSummaries:u,sortOptions:x,sortOption:p,handleSortChange:f,bundles:j,selectedBundleId:T,setSelectedBundleId:E,selectedProductId:h,setSelectedProductId:i,shopifyProducts:A,getNumericProductId:C,getGidProductId:z,getProductTitleFromNumericId:N,getProductImageFromNumericId:_}){var Z;const[Q,se]=a.useState(!1),$=a.useCallback(()=>se(R=>!R),[]),re=a.useCallback(R=>{f(R),se(!1)},[f]),ee=[{id:"all-reviews",content:"All Reviews",panelID:"all-reviews-panel",badge:s>0?String(s):void 0},{id:"product-summary",content:"Product Ratings Overview",panelID:"product-summary-panel",badge:u.length>0?String(u.length):void 0},{id:"bundle-reviews",content:"Bundle Review Approvals",panelID:"bundle-reviews-panel",badge:j.length>0?String(j.length):void 0}],O=[...u].sort((R,L)=>{switch(p){case"highest-rating":return parseFloat(L.averageRating)-parseFloat(R.averageRating);case"lowest-rating":return parseFloat(R.averageRating)-parseFloat(L.averageRating);case"most-reviews":return L.totalReviews-R.totalReviews;case"least-reviews":return R.totalReviews-L.totalReviews;default:return 0}}),U=((Z=x.find(R=>R.value===p))==null?void 0:Z.label)||"Sort by",H=()=>{switch(t){case 0:return e.jsxs(k,{gap:"400",children:[e.jsx(v,{as:"h2",variant:"headingLg",fontWeight:"semibold",children:"All Customer Reviews"}),e.jsx(je,{}),e.jsx(I,{padding:"500",children:b.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{reviews:b,actionSource:"individual"}),c>1&&e.jsx(I,{paddingBlockStart:"400",paddingBlockEnd:"200",children:e.jsx(F,{align:"center",children:e.jsx(Et,{hasPrevious:m,onPrevious:()=>d(o-1),hasNext:n,onNext:()=>d(o+1),label:`Page ${o} of ${c}`})})})]}):e.jsx(v,{as:"p",children:"No reviews yet."})})]});case 1:return e.jsxs(k,{gap:"400",children:[e.jsxs(F,{align:"space-between",blockAlign:"center",children:[e.jsx(v,{as:"h2",variant:"headingLg",fontWeight:"semibold",children:"Product Ratings Overview (Individual Approvals)"}),e.jsx(Ze,{active:Q,activator:e.jsx(ne,{onClick:$,disclosure:!0,icon:ft,children:U}),onClose:$,children:e.jsx(ot,{items:x.map(w=>({content:w.label,onAction:()=>re(w.value),active:p===w.value}))})})]}),e.jsx(je,{}),e.jsx(I,{padding:"500",children:O.length>0?e.jsx(ma,{productSummaries:O,actionSource:"individual"}):e.jsx(v,{as:"p",children:"No products with reviews yet."})})]});case 2:const R=j.find(w=>w.id===T),L=u.find(w=>C(w.productId)===h);if(L&&h&&R){const w=L.individualReviews;return e.jsxs(k,{gap:"400",children:[e.jsx(I,{padding:"400",background:"bg-fill-info-secondary",borderRadius:"200",children:e.jsxs(F,{align:"start",blockAlign:"center",gap:"400",children:[e.jsx(ne,{onClick:()=>i(null),size:"slim",children:"â† Back to Bundle Products"}),e.jsxs(k,{gap:"100",children:[e.jsx(v,{as:"h2",variant:"headingLg",fontWeight:"semibold",children:L.productName}),e.jsxs(v,{as:"p",variant:"bodyMd",tone:"subdued",children:["Part of Bundle: ",R.name]}),e.jsxs(v,{as:"p",variant:"bodySm",tone:"subdued",children:["Status: ",w.filter(M=>M.status==="pending").length," Pending,",w.filter(M=>M.status==="approved").length," Approved,",w.filter(M=>M.status==="rejected").length," Rejected"]})]})]})}),e.jsxs(v,{as:"h3",variant:"headingMd",fontWeight:"medium",children:["All Reviews for Syndication (",w.length,")"]}),e.jsx(je,{}),e.jsx(I,{padding:"500",children:w.length>0?e.jsx(Ue,{reviews:w,actionSource:"bundle"}):e.jsx(v,{as:"p",children:"No reviews found for this product."})})]})}if(R&&T){const w=R.productIds;return e.jsxs(k,{gap:"400",children:[e.jsx(I,{padding:"400",background:"bg-fill-info-secondary",borderRadius:"200",children:e.jsxs(F,{align:"start",blockAlign:"center",gap:"400",children:[e.jsx(ne,{onClick:()=>E(null),size:"slim",children:"â† Back to Bundles List"}),e.jsxs(k,{gap:"100",children:[e.jsxs(v,{as:"h2",variant:"headingLg",fontWeight:"semibold",children:["Bundle: ",R.name]}),e.jsxs(v,{as:"p",variant:"bodyMd",tone:"subdued",children:["Products: ",w.length]})]})]})}),e.jsx(v,{as:"h3",variant:"headingMd",fontWeight:"medium",children:"Products in Bundle"}),e.jsx(je,{}),e.jsx(I,{padding:"500",children:e.jsx($e,{resourceName:{singular:"product",plural:"products"},items:w,renderItem:M=>{const G=N(M),W=_(M),V=u.find(te=>C(te.productId)===M),me=(V==null?void 0:V.individualReviews.length)||0,be=(V==null?void 0:V.individualReviews.filter(te=>te.status==="pending").length)||0,ge=(V==null?void 0:V.individualReviews.filter(te=>te.status==="approved").length)||0,fe=z(M);return e.jsx(ze,{id:fe,url:"#",media:e.jsx(ut,{source:W||"https://via.placeholder.com/80",alt:G,size:"small"}),accessibilityLabel:`View reviews for ${G}`,onClick:()=>i(M),children:e.jsxs(k,{gap:"100",children:[e.jsx(v,{as:"h3",variant:"bodyLg",fontWeight:"semibold",children:G}),e.jsxs(F,{gap:"200",blockAlign:"center",children:[M===R.bundleProductId&&e.jsx(q,{tone:"success",size:"small",children:"Main"}),e.jsx(q,{tone:"info",size:"small",children:`${me} Total Review${me!==1?"s":""}`}),be>0&&e.jsx(q,{tone:"attention",size:"small",children:`${be} Pending`}),ge>0&&e.jsx(q,{tone:"success",size:"small",children:`${ge} Approved`}),e.jsx(q,{size:"small",children:`ID: ${M}`})]})]})})}})})]})}return e.jsxs(k,{gap:"400",children:[e.jsxs(F,{align:"space-between",blockAlign:"center",children:[e.jsx(v,{as:"h2",variant:"headingLg",fontWeight:"semibold",children:"Select Bundle for Approval"}),e.jsx(q,{tone:"info",size:"large",children:`${j.length} bundles created`})]}),e.jsx(je,{}),e.jsx(I,{padding:"500",children:j.length>0?e.jsx($e,{resourceName:{singular:"bundle",plural:"bundles"},items:j,renderItem:w=>{const M=w.productIds.length,G=N(w.bundleProductId);return e.jsx(ze,{id:w.id,url:"#",media:e.jsx(he,{source:Ft,tone:"base"}),accessibilityLabel:`View bundle ${w.name}`,onClick:()=>E(w.id),children:e.jsxs(k,{gap:"100",children:[e.jsx(v,{as:"h3",variant:"bodyLg",fontWeight:"semibold",children:w.name}),e.jsxs(F,{gap:"100",blockAlign:"center",wrap:!1,children:[e.jsx(q,{size:"small",tone:"success",children:`Main: ${G}`}),e.jsx(q,{size:"small",children:`+${M-1} ${M-1===1?"Product":"Products"}`})]})]})})}}):e.jsxs(k,{gap:"200",align:"center",children:[e.jsx(v,{as:"p",alignment:"center",children:"No Review Bundles configured yet."}),e.jsx(zt,{url:"/app/create-bundle",children:"Create your first bundle now."})]})})]});default:return null}};return e.jsx(na,{tabs:ee,selected:t,onSelect:l,children:e.jsx(I,{paddingBlockStart:"400",children:H()})})}function Aa(){const{reviews:t,totalReviews:l,averageRating:s,currentPage:b,productSummaries:c,bundles:o,shopifyProducts:m,csvFile:n,activeToast:d,toastMessage:u,toastError:x,selectedTab:p,selectedBundleId:f,selectedProductId:j,sortOption:T,isExporting:E,isImporting:h,isDownloadingSample:i,pageCount:A,hasNext:C,hasPrevious:z,handlePageChange:N,handleFileChange:_,handleRemoveFile:Q,handleExportCSV:se,handleDownloadSampleCSV:$,handleImportCSV:re,handleTabChange:ee,handleSortChange:O,setSelectedBundleId:U,setSelectedProductId:H,setActiveToast:Z}=ra(),R=G=>{const W=m.find(V=>V.numericId===G);return(W==null?void 0:W.title)||`Product ${G}`},L=G=>{const W=m.find(V=>V.numericId===G);return(W==null?void 0:W.imageUrl)||null},w=[{label:"Highest Rating",value:"highest-rating"},{label:"Lowest Rating",value:"lowest-rating"},{label:"Most Reviews",value:"most-reviews"},{label:"Least Reviews",value:"least-reviews"}],M=d?e.jsx(Ot,{content:u,onDismiss:()=>Z(!1),error:x}):null;return e.jsxs(St,{fullWidth:!0,children:[e.jsxs(k,{gap:"400",children:[e.jsx(Ut,{title:"GWL - Reviews Management Hub"}),e.jsxs(Ne,{children:[e.jsx(Ne.Section,{children:e.jsx(k,{gap:"400",children:e.jsx(sa,{totalReviews:l,averageRating:s})})}),e.jsx(Ne.Section,{children:e.jsx(la,{isExporting:E,isImporting:h,isDownloadingSample:i,handleExportCSV:se,csvFile:n,handleFileChange:_,handleRemoveFile:Q,handleImportCSV:re,handleDownloadSampleCSV:$})}),e.jsx(Ne.Section,{children:e.jsx(ba,{selectedTab:p,handleTabChange:ee,totalReviews:l,reviews:t,pageCount:A,currentPage:b,hasPrevious:z,hasNext:C,handlePageChange:N,productSummaries:c,sortOptions:w,sortOption:T,handleSortChange:O,bundles:o,selectedBundleId:f,setSelectedBundleId:U,selectedProductId:j,setSelectedProductId:H,shopifyProducts:m,getNumericProductId:_t,getGidProductId:Wt,getProductTitleFromNumericId:R,getProductImageFromNumericId:L})})]})]}),M]})}export{Aa as default};
